<h1>Footy Subs</h1>

<% if signed_in? %>
<p>	
	<%= link_to "Profile", current_user %>
</p>
<p>
	<%= link_to "Post match", new_event_path %>
</p>
<% else %>
	<%= link_to "Sign in", signin_path %> or <%= link_to "Sign up", new_user_path %> to join or post match
<% end %> 

<ul>

	<% if signed_in? %>

		<% @all_events.each do |e| %>
			<% if e.status == "open" && e.users.include?(current_user) %>
				<li><%= link_to(event_path(e.id)) do %><%= e.start.strftime("%a, %b %e at %l:%M%P") %><% end %></li>
				<li><%= e.location %></li>
				<li>Joined</li>
				<br />
			<% elsif e.status == "full" && e.users.include?(current_user) %>
				<li><%= link_to(event_path(e.id)) do %><%= e.start.strftime("%a, %b %e at %l:%M%P") %><% end %></li>
				<li><%= e.location %></li>
				<li>Joined</li>
				<br />
			<% elsif e.status == "open" && e.users.exclude?(current_user) %>
				<li><%= link_to(event_path(e.id)) do %><%= e.start.strftime("%a, %b %e at %l:%M%P") %><% end %></li>
				<li><%= e.location %></li>
				<li><%= e.users.count %> / <%= e.needed %></li>
				<br />
			<% elsif e.status == "full" && e.users.exclude?(current_user) %>
				<li><%= link_to(event_path(e.id)) do %><%= e.start.strftime("%a, %b %e at %l:%M%P") %><% end %></li>
				<li><%= e.location %></li>
				<li>Full</li>
				<br />
			<% end %>
		<% end %>

		<% @events.each do |e| %>
			<% if e.status == "ended" %>
				<li><%= link_to(event_path(e.id)) do %><%= e.start.strftime("%a, %b %e at %l:%M%P") %><% end %></li>
				<li><%= e.location %></li>
				<li>Ended</li>
				<br />
			<% end %>
		<% end %>

	<% end %>

	<% if ! signed_in? %>
		
		<% @open.each do |e| %>
				<li><%= link_to(event_path(e.id)) do %><%= e.start.strftime("%a, %b %e at %l:%M%P") %><% end %></li>
				<li><%= e.location %></li>
				<li><%= e.users.count %> / <%= e.needed %></li>
				<br />
		<% end %>

		<% @full.each do |e| %>
			<li><%= link_to(event_path(e.id)) do %><%= e.start.strftime("%a, %b %e at %l:%M%P") %><% end %></li>
			<li><%= e.location %></li>
			<li>Full</li>
			<br />
		<% end %>

		<% @events.each do |e| %>
			<% if e.status == "ended" %>
				<li><%= link_to(event_path(e.id)) do %><%= e.start.strftime("%a, %b %e at %l:%M%P") %><% end %></li>
				<li><%= e.location %></li>
				<li>Ended</li>
				<br />
			<% end %>
		<% end %>

	<% end %>

</ul>
